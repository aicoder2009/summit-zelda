<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <link href='https://fonts.googleapis.com/css?family=Cabin' rel='stylesheet'>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="./logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href='https://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet'>
    <script>
      if (window.location.origin.substring(0,4)==="http"&&window.location.origin.charAt(4)!=="s"){
        //not https!
        window.location="https://"+window.location.href.substring(7);
      }
    </script>
    <script>
      tailwind.config = {
        theme: {
          screens: {
            sm: '0px',
            md: '700px',
            lg: '1200px',
            xl: '1600px'
          }
        }
      }
    </script>
    <script>
      var navMenuShown = false;
      var gebi = function(e){return document.getElementById(e)};
    </script>
    <title>Toolbox Customization Codelab</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="custom_category_es6.js"></script>
    <script src="toolbox_label_es6.js"></script>
    <link rel="stylesheet" href="toolbox_style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  </head>
  <body onscroll="(function(){if(window.scrollY>10)document.getElementById('navbar').style.backgroundColor='rgba(0,0,0,1)'; else if (window.scrollY<10)document.getElementById('navbar').style.backgroundColor='rgba(0,0,0,0.5)'})()">
    <!--navbar-->
    <nav id="navbar" class="left-0 top-0 z-50 flex items-center justify-between flex-wrap w-screen fixed pr-4 pl-2" style="height:40px; font-family: 'Merriweather';transition: background-color 200ms linear; background-color:rgba(0,0,0,0.5)">
      <div class="flex items-center flex-shrink-0 text-white mr-6 pl-2" onclick="(function(){window.location=window.location.origin+'/summit-zelda'})()">
        <button class="text-xl tracking-tight">Summit Zelda</span>
      </div>
      <div class="block md:hidden">
        <button id="menuToggle" class="flex items-center px-3 py-2 border rounded text-gray-300 border-gray-300 hover:text-white hover:border-white">
          <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Summit Zelda</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg>
        </button>
      </div>
      <div id="navItemContainer" class="w-full block flex-grow md:flex md:items-center md:justify-end md:w-auto text-sm" style="height:100%">
        <div onclick="(function(){window.location=window.location.origin+'/summit-zelda'})()" class="block mt-4 md:flex md:items-center md:pl-2 md:pr-2 md:mt-0 text-gray-200 hover:text-white" style="height:100%;cursor:pointer;">Home</div>
      </div>
    </nav>
    <div class="absolute left-0 top-0 -z-10 bg-cover bg-fixed bg-repeat-y" style="width:100%;height:500vh;background-image:url('./kimi-bg.png')"></div>
    <font style="font-family: 'Cabin';">
    <center>
      <div id="contentBox" class="relative flex flex-col w-9/12 mt-24 rounded-xl justify-center items-center bg-gray-100" style="height:80vh;">
        <div id="menu" class="flex flex-row justify-center items-center">
          <p id="menuTitle" class="text-xl"></p>
          <button id="menuPlay" class="main" onclick="window.location.href='main.html'">Play! >></button>
        </div>
        <div id="game" style="display:none">
          <div id="gameLeft">
            <div id="gameGame">
              <div id="blocklyArea" style="height:75%;width:75%"></div>
              <div id="blocklyDiv" style="position:absolute;"></div>
            </div>
            <xml
            xmlns="https://developers.google.com/blockly/xml"
            id="toolbox-categories"
            style="display: none">
              <toolboxlabel name="Custom Toolbox" colour="darkslategrey"></toolboxlabel>
              <category
                css-icon="customIcon fa fa-cog"
                name="Logic"
                categorystyle="logic_category">
                <block type="controls_if"></block>
                <block type="logic_compare"></block>
                <block type="logic_operation"></block>
                <block type="logic_negate"></block>
                <block type="logic_boolean"></block>
                <block type="logic_null" disabled="true"></block>
                <block type="logic_ternary"></block>
              </category>
              <category name="Loops" categorystyle="loop_category">
                <block type="controls_repeat_ext">
                  <value name="TIMES">
                    <shadow type="math_number">
                      <field name="NUM">10</field>
                    </shadow>
                  </value>
                </block>
                <block type="controls_repeat" disabled="true"></block>
                <block type="controls_whileUntil"></block>
                <block type="controls_for">
                  <value name="FROM">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                  <value name="TO">
                    <shadow type="math_number">
                      <field name="NUM">10</field>
                    </shadow>
                  </value>
                  <value name="BY">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                </block>
                <block type="controls_forEach"></block>
                <block type="controls_flow_statements"></block>
              </category>
              <category name="Math" categorystyle="math_category">
                <block type="math_number" gap="32">
                  <field name="NUM">123</field>
                </block>
                <block type="math_arithmetic">
                  <value name="A">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                  <value name="B">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_single">
                  <value name="NUM">
                    <shadow type="math_number">
                      <field name="NUM">9</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_trig">
                  <value name="NUM">
                    <shadow type="math_number">
                      <field name="NUM">45</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_constant"></block>
                <block type="math_number_property">
                  <value name="NUMBER_TO_CHECK">
                    <shadow type="math_number">
                      <field name="NUM">0</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_round">
                  <value name="NUM">
                    <shadow type="math_number">
                      <field name="NUM">3.1</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_on_list"></block>
                <block type="math_modulo">
                  <value name="DIVIDEND">
                    <shadow type="math_number">
                      <field name="NUM">64</field>
                    </shadow>
                  </value>
                  <value name="DIVISOR">
                    <shadow type="math_number">
                      <field name="NUM">10</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_constrain">
                  <value name="VALUE">
                    <shadow type="math_number">
                      <field name="NUM">50</field>
                    </shadow>
                  </value>
                  <value name="LOW">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                  <value name="HIGH">
                    <shadow type="math_number">
                      <field name="NUM">100</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_random_int">
                  <value name="FROM">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                  <value name="TO">
                    <shadow type="math_number">
                      <field name="NUM">100</field>
                    </shadow>
                  </value>
                </block>
                <block type="math_random_float"></block>
                <block type="math_atan2">
                  <value name="X">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                  <value name="Y">
                    <shadow type="math_number">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                </block>
              </category>
              <category name="Text" categorystyle="text_category">
                <block type="text"></block>
                <block type="text_multiline"></block>
                <block type="text_join"></block>
                <block type="text_append">
                  <value name="TEXT">
                    <shadow type="text"></shadow>
                  </value>
                </block>
                <block type="text_length">
                  <value name="VALUE">
                    <shadow type="text">
                      <field name="TEXT">abc</field>
                    </shadow>
                  </value>
                </block>
                <block type="text_isEmpty">
                  <value name="VALUE">
                    <shadow type="text">
                      <field name="TEXT"></field>
                    </shadow>
                  </value>
                </block>
                <block type="text_indexOf">
                  <value name="VALUE">
                    <block type="variables_get">
                      <field name="VAR">text</field>
                    </block>
                  </value>
                  <value name="FIND">
                    <shadow type="text">
                      <field name="TEXT">abc</field>
                    </shadow>
                  </value>
                </block>
                <block type="text_charAt">
                  <value name="VALUE">
                    <block type="variables_get">
                      <field name="VAR">text</field>
                    </block>
                  </value>
                </block>
                <block type="text_getSubstring">
                  <value name="STRING">
                    <block type="variables_get">
                      <field name="VAR">text</field>
                    </block>
                  </value>
                </block>
                <block type="text_changeCase">
                  <value name="TEXT">
                    <shadow type="text">
                      <field name="TEXT">abc</field>
                    </shadow>
                  </value>
                </block>
                <block type="text_trim">
                  <value name="TEXT">
                    <shadow type="text">
                      <field name="TEXT">abc</field>
                    </shadow>
                  </value>
                </block>
                <block type="text_count">
                  <value name="SUB">
                    <shadow type="text"></shadow>
                  </value>
                  <value name="TEXT">
                    <shadow type="text"></shadow>
                  </value>
                </block>
                <block type="text_replace">
                  <value name="FROM">
                    <shadow type="text"></shadow>
                  </value>
                  <value name="TO">
                    <shadow type="text"></shadow>
                  </value>
                  <value name="TEXT">
                    <shadow type="text"></shadow>
                  </value>
                </block>
                <block type="text_reverse">
                  <value name="TEXT">
                    <shadow type="text"></shadow>
                  </value>
                </block>
                <label text="Input/Output:" web-class="ioLabel"></label>
                <block type="text_print">
                  <value name="TEXT">
                    <shadow type="text">
                      <field name="TEXT">abc</field>
                    </shadow>
                  </value>
                </block>
                <block type="text_prompt_ext">
                  <value name="TEXT">
                    <shadow type="text">
                      <field name="TEXT">abc</field>
                    </shadow>
                  </value>
                </block>
              </category>
              <category name="Lists" categorystyle="list_category">
                <block type="lists_create_with">
                  <mutation items="0"></mutation>
                </block>
                <block type="lists_create_with"></block>
                <block type="lists_repeat">
                  <value name="NUM">
                    <shadow type="math_number">
                      <field name="NUM">5</field>
                    </shadow>
                  </value>
                </block>
                <block type="lists_length"></block>
                <block type="lists_isEmpty"></block>
                <block type="lists_indexOf">
                  <value name="VALUE">
                    <block type="variables_get">
                      <field name="VAR">list</field>
                    </block>
                  </value>
                </block>
                <block type="lists_getIndex">
                  <value name="VALUE">
                    <block type="variables_get">
                      <field name="VAR">list</field>
                    </block>
                  </value>
                </block>
                <block type="lists_setIndex">
                  <value name="LIST">
                    <block type="variables_get">
                      <field name="VAR">list</field>
                    </block>
                  </value>
                </block>
                <block type="lists_getSublist">
                  <value name="LIST">
                    <block type="variables_get">
                      <field name="VAR">list</field>
                    </block>
                  </value>
                </block>
                <block type="lists_split">
                  <value name="DELIM">
                    <shadow type="text">
                      <field name="TEXT">,</field>
                    </shadow>
                  </value>
                </block>
                <block type="lists_sort"></block>
                <block type="lists_reverse"></block>
              </category>
              <category name="Colour" categorystyle="colour_category">
                <block type="colour_picker"></block>
                <block type="colour_random"></block>
                <block type="colour_rgb">
                  <value name="RED">
                    <shadow type="math_number">
                      <field name="NUM">100</field>
                    </shadow>
                  </value>
                  <value name="GREEN">
                    <shadow type="math_number">
                      <field name="NUM">50</field>
                    </shadow>
                  </value>
                  <value name="BLUE">
                    <shadow type="math_number">
                      <field name="NUM">0</field>
                    </shadow>
                  </value>
                </block>
                <block type="colour_blend">
                  <value name="COLOUR1">
                    <shadow type="colour_picker">
                      <field name="COLOUR">#ff0000</field>
                    </shadow>
                  </value>
                  <value name="COLOUR2">
                    <shadow type="colour_picker">
                      <field name="COLOUR">#3333ff</field>
                    </shadow>
                  </value>
                  <value name="RATIO">
                    <shadow type="math_number">
                      <field name="NUM">0.5</field>
                    </shadow>
                  </value>
                </block>
              </category>
              <sep></sep>
              <category
                name="Variables"
                categorystyle="variable_category"
                custom="VARIABLE"></category>
              <category
                name="Functions"
                categorystyle="procedure_category"
                custom="PROCEDURE"></category>
            </xml>
            <div id="gameTools"></div>
          </div>
          <div id="gameRight">
            <button id="save" class="absolute top:0 right:0" disabled>Save</button>
          </div>
        </div>
      </div>
    </center>
    </font>
    <style>
      .main{
        border-radius:8px;
        border:2px solid #000000;
        font-size:20px;
        font-family:'Cabin';
        outline:none;
        margin-bottom:20px; /* NOTE this is gap betw buttons */
      }
      #menuPlay{
        background-color:rgb(54, 219, 54);
      }
      #menuPlay:disabled{
        background-color:rgb(170, 255, 170);
      }
      #menuPlay:hover{
        background-color:rgb(48, 194, 48);
      }
    </style>
    <style>
      html,
      body {
        height: 100%;
        scroll-behavior:smooth;
      }

      body {
        background-color: #fff;
        font-family: sans-serif;
        overflow: hidden;
      }

      #blocklyDiv {
        float: bottom;
        height: 90%;
        width: 100%;
      }

      #blockyArea {
        width:100%;
        height:90%;
      }
    </style>
    <script src="https://unpkg.com/blockly"></script>
    <script>
      let currentButton;
      function loadWorkspace(button) {
        const workspace = Blockly.getMainWorkspace();
        if (button.blocklySave) {
        Blockly.serialization.workspaces.load(button.blocklySave, workspace);
        } else {
        workspace.clear();
        }
      }
      const toolbox = {
        'kind': 'flyoutToolbox',
        'contents': [
        {
          'kind': 'block',
          'type': 'controls_repeat_ext',
          'inputs': {
          'TIMES': {
            'shadow': {
            'type': 'math_number',
            'fields': {
              'NUM': 5
            }
            }
          }
          }
        }
        ]
      };
      var blocklyArea = document.getElementById('blocklyArea');
      var blocklyDiv = document.getElementById('blocklyDiv');
      var workspace = Blockly.inject('gameGame', {
        toolbox: toolbox,
        scrollbars: false,
        horizontalLayout: true,
        toolboxPosition: "end",
      });
      var resize = function(){
        if (window.innerWidth<700){
          //small
        }else{
          //med + lg++
          var xSplit = 0.75;
          gebi("gameLeft").style.width=(window.innerWidth*xSplit-2)+"px";
          gebi("gameRight").style.width=(window.innerWidth*(1-xSplit)-2)+"px";
          gebi("gameRight").style.left=(window.innerWidth*xSplit-2)+"px";
          var ySplit = 0.8;
          gebi("gameGame").style.height=(window.innerHeight*ySplit-2)+"px";
          gebi("gameTools").style.height=(window.innerHeight*(1-ySplit)-2)+"px";
          gebi("gameTools").style.top=(window.innerHeight*ySplit-2)+"px";

          var element = blocklyArea;
          let x = 0;
          let y = 0;
          do {
            x += element.offsetLeft;
            y += element.offsetTop;
            element = element.offsetParent;
          } while (element);
          // Position blocklyDiv over blocklyArea.
          blocklyDiv.style.left = x + 'px';
          blocklyDiv.style.top = y + 'px';
          blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
          blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
          Blockly.svgResize(workspace);
        }
      }
      window.onresize=resize;
      resize();
      gebi("menuPlay").addEventListener("click",function(){
        gebi("navbar").style.display="none";
        gebi("menu").style.display="none";
        gebi("game").style.display="";
      })
    </script>
  </body>
</html>