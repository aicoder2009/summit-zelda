<!DOCTYPE html>
<html>
  <head>
    <title>Summit Zelda</title>
    <link href='https://fonts.googleapis.com/css?family=Cabin' rel='stylesheet'>
    <meta charset="UTF-8">
    <link rel="icon" href="https://e2009.s3.us-west-1.amazonaws.com/Summit+App+Design+Favicon.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href='https://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet'>
    <script>
      if (window.location.origin.substring(0,4)==="http"&&window.location.origin.charAt(4)!=="s"){
        //not https!
        window.location="https://"+window.location.href.substring(7);
      }
    </script>
    <script>
      tailwind.config = {
        theme: {
          screens: {
            sm: '0px',
            md: '700px',
            lg: '1200px',
            xl: '1600px'
          }
        }
      }
    </script>
    <script>
      var navMenuShown = false;
      var gebi = function(e){return document.getElementById(e)};
    </script>
    <title>Summit Zelda</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="custom_category_es6.js"></script>
    <script src="toolbox_label_es6.js"></script>
    <link rel="stylesheet" href="toolbox_style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Summit Zelda</title>
    <meta http-equiv="content-script-type" content="text/javascript" />
    <meta http-equiv="content-style-type" content="text/css" />
    <link type="text/css" href="ct.3733e7e826.css" rel="stylesheet" />
  
    <!-- icons and brand metadata go here -->
    <!--add-meta start-->
    <meta name="name" content="Summit Zelda">
    <meta name="description" content="Summit Zelda is a project that was built during the Hackclub Leader Summit 2024 Hackathon.
    The goal for Summit Zelda was for hackclubs to be able to learn basic coding easily using a
    very popular game, Zelda, and the easiest language to learn, block code, to teach hackclubbers
    how to code javascript with Zelda.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Summit Zelda">
    <meta property="og:image" content="https://e2009.s3.us-west-1.amazonaws.com/Summit+App+Design+Favicon.png">
    <meta property="og:description" content="Summit Zelda is a project that was built during the Hackclub Leader Summit 2024 Hackathon.
    The goal for Summit Zelda was for hackclubs to be able to learn basic coding easily using a
    very popular game, Zelda, and the easiest language to learn, block code, to teach hackclubbers
    how to code javascript with Zelda.">
    <meta name="link:card" content="https://e2009.s3.us-west-1.amazonaws.com/Summit+App+Design+Favicon.png">
    <link rel="shortcut icon" href="https://e2009.s3.us-west-1.amazonaws.com/Summit+App+Design+Favicon.png" type="image/x-icon">
    <!--add-meta end-->
    <meta name="theme-color" content="#446adb">
    <meta name="application-name" content="Summit Zelda">
    <link rel="icon" href="https://e2009.s3.us-west-1.amazonaws.com/Summit+App+Design+Favicon.png" type="image/x-icon">
    <!--<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.default.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.default.png">
    <link rel="icon" type="image/png" sizes="48x48" href="favicon-48x48.default.png">
    <link rel="icon" type="image/png" sizes="64x64" href="favicon-64x64.default.png">-->
  
    <meta name="apple-mobile-web-app-capable" content="no">
  
    <link rel="apple-touch-icon" sizes="57x57" href="apple-touch-icon-57x57.default.png">
    <link rel="apple-touch-icon" sizes="60x60" href="apple-touch-icon-60x60.default.png">
    <link rel="apple-touch-icon" sizes="72x72" href="apple-touch-icon-72x72.default.png">
    <link rel="apple-touch-icon" sizes="76x76" href="apple-touch-icon-76x76.default.png">
    <link rel="apple-touch-icon" sizes="114x114" href="apple-touch-icon-114x114.default.png">
    <link rel="apple-touch-icon" sizes="120x120" href="apple-touch-icon-120x120.default.png">
    <link rel="apple-touch-icon" sizes="144x144" href="apple-touch-icon-144x144.default.png">
    <link rel="apple-touch-icon" sizes="152x152" href="apple-touch-icon-152x152.default.png">
    <link rel="apple-touch-icon" sizes="167x167" href="apple-touch-icon-167x167.default.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon-180x180.default.png">
    <link rel="apple-touch-icon" sizes="1024x1024" href="apple-touch-icon-1024x1024.default.png">
  
    <!-- Opera Coast-->
    <!--<link rel="icon" type="image/png" sizes="228x228" href="coast-228x228.default.png">-->
  
    <meta name="msapplication-TileColor" content="#446adb">
    <meta name="msapplication-TileImage" content="mstile-144x144.default.png">


  </head>
  <body>
    <!--navbar-->
    <nav id="navbar" class="left-0 top-0 z-50 flex items-center justify-between flex-wrap w-screen fixed pr-4 pl-2" style="height:40px; font-family: 'Merriweather';transition: background-color 200ms linear; background-color:rgba(0,0,0,0.5)">
      <div class="flex items-center flex-shrink-0 text-white mr-6 pl-2" onclick="(function(){window.location=window.location.origin+'/summit-zelda'})()">
        <button class="text-xl tracking-tight">Summit Zelda</span>
      </div>
      <div class="block md:hidden">
        <button id="menuToggle" class="flex items-center px-3 py-2 border rounded text-gray-300 border-gray-300 hover:text-white hover:border-white">
          <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Summit Zelda</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg>
        </button>
      </div>
      <div id="navItemContainer" class="w-full block flex-grow md:flex md:items-center md:justify-end md:w-auto text-sm" style="height:100%">
        <div onclick="(function(){window.location=window.location.origin+'/summit-zelda'})()" class="block mt-4 md:flex md:items-center md:pl-2 md:pr-2 md:mt-0 text-gray-200 hover:text-white" style="height:100%;cursor:pointer;">Home</div>
      </div>
    </nav>
    <div class="absolute left-0 top-0 -z-10 bg-cover bg-fixed bg-repeat-y" style="width:100%;height:500vh;background-image:url('./kimi-bg.png')"></div>
    <font style="font-family: 'Cabin';">
    <center>
      <div id="contentBox" class="relative flex flex-col w-9/12 mt-24 rounded-xl justify-center items-center bg-gray-100" style="height:95vh; overflow: auto;">
        <div id="menu" class="flex flex-col justify-center items-center" style="width:100%;height:100%;">
            <p id="menuTitle" class="text-xl" style="padding: 15px;">Summit Zelda</p>
            <p id="menuSubtitle" class="text-sm"style="padding: 15px;">Summit Zelda is a project that was built during the Hackclub Leader Summit 2024 Hackathon.
                The goal for Summit Zelda was for hackclubs to be able to learn basic coding easily using a
                very popular game, Zelda, and the easiest language to learn, block code, to teach hackclubbers
                how to code javascript with Zelda. </p>
            <button id="menuPlay" class="main" style="padding: 15px; width:35%; height:5%;">Start Hacking >>></button>
        </div>
    </div>
    </center>
    <div id="game" style="display:none;width:100%;height:100%;">
      <div id="gameLeft" style="position:absolute;">
        <div id="gameGame" style="width:100%;position:absolute;">
          <button onclick="eval(Blockly.JavaScript.workspaceToCode(workspace));"></button>
          <div id="blocklyArea" style="position:absolute;left:0;top:0;height:100%;width:100%"></div>
          <div id="blocklyDiv" style="position:absolute;"></div>
          <xml
          xmlns="https://developers.google.com/blockly/xml"
          id="toolbox-categories"
          style="display: none">
            <toolboxlabel colour="darkslategrey"></toolboxlabel>
            <category
              css-icon="customIcon fa fa-cog"
              name="Logic"
              categorystyle="logic_category">
              <block type="controls_if"></block>
              <block type="logic_compare"></block>
              <block type="logic_operation"></block>
              <block type="logic_negate"></block>
              <block type="logic_boolean"></block>
              <block type="logic_null" disabled="true"></block>
              <block type="logic_ternary"></block>
            </category>
            <category name="Movement">
              <block type="up"></block>
              <block type="down"></block>
              <block type="left"></block>
              <block type="right"></block>
            </category>
            <category name="Loops" categorystyle="loop_category">
              <block type="controls_repeat_ext">
                <value name="TIMES">
                  <shadow type="math_number">
                    <field name="NUM">10</field>
                  </shadow>
                </value>
              </block>
              <block type="controls_whileUntil"></block>
              <block type="controls_for">
                <value name="FROM">
                  <shadow type="math_number">
                    <field name="NUM">1</field>
                  </shadow>
                </value>
                <value name="TO">
                  <shadow type="math_number">
                    <field name="NUM">10</field>
                  </shadow>
                </value>
                <value name="BY">
                  <shadow type="math_number">
                    <field name="NUM">1</field>
                  </shadow>
                </value>
              </block>
              <block type="controls_forEach"></block>
              <block type="controls_flow_statements"></block>
            </category>
            <sep></sep>
            <category
              name="Variables"
              categorystyle="variable_category"
              custom="VARIABLE"></category>
            <category
              name="Functions"
              categorystyle="procedure_category"
              custom="PROCEDURE"></category>
          </xml>
          <p id="jsDiv" style="position:absolute;left:0;top:0;height:100%;width:100%;display:none;"></p>
        </div>
        <div id="gameTools" class="flex justify-center items-center" style="width:100%;position:absolute;">
          <button id="run" class="main">Run <font style="position:absolute;right:10px; color:rgb(18, 172, 18)">></font></button>
          <div class="sliderContainer">
            <div class="paragraphContainer">
              <p class="sliderDescription">Blocks</p>
            </div>
            <label class="sliderSwitch">
              <input type="checkbox" id="sliderCheckBox">
              <span class="sliderSlider"></span>
            </label>
            <div class="paragraphContainer">
              <p class="sliderDescription">JS</p>
            </div>
            </div>
          </div>
        </div>
      </div>
    <div id="gameRight" style="position:absolute;">
        <!-- <button id="save" style="position:absolute; top:10px; right:10px;" disabled>Save</button> -->
        <iframe id="zelda" width="100%" height="100%" src="./game/index.html" title="e"></iframe> 
    </div>

    </div>
    </font>
    <style>
      .main{
        border-radius:8px;
        border:2px solid #000000;
        font-size:20px;
        font-family:'Cabin';
        outline:none;
        margin-bottom:20px; /* NOTE this is gap betw buttons */
      }
      #menuPlay{
        background-color:rgb(54, 219, 54);
      }
      #menuPlay:disabled{
        background-color:rgb(170, 255, 170);
      }
      #menuPlay:hover{
        background-color:rgb(48, 194, 48);
      }
    </style>
    <style>
      html,
      body {
        height: 100%;
        scroll-behavior:smooth;
      }

      body {
        background-color: #fff;
        font-family: sans-serif;
        overflow: hidden;
      }

      #blocklyDiv {
        float: bottom;
        height: 90%;
        width: 100%;
      }

      #blockyArea {
        width:100%;
        height:90%;
      }
    </style>
    <style>
      .sliderContainer{
        position:relative;
        display:flex;
        flex-direction:row;
        justify-content:start;
        align-items:center;
      }
      .paragraphDescription{
        position:relative;
      }
      .sliderDescription{
        font-size:20px;
        margin:0;
        padding:0;
      }
      .sliderSwitch {
        position:relative;
        display:inline-block;
        width:60px;
        height:34px;
        margin-left:8px;
        margin-right:8px;
      }
      .sliderSwitch input {
        opacity:0;
        width:0;
        height:0;
      }
      .sliderSlider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
        border-radius: 34px;
      }
      .sliderSlider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: rgb(129, 165, 249);
        -webkit-transition: .4s;
        transition: .4s;
        border-radius: 50%;
      }
      .sliderCheckBox:checked + #sliderSlider {
        background-color: rgb(11, 62, 179);
      }
      .sliderCheckBox:checked + #sliderSlider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
      }
    </style>
    <script>
      let currentButton;
      function loadWorkspace(button) {
        const workspace = Blockly.getMainWorkspace();
        if (button.blocklySave) {
        Blockly.serialization.workspaces.load(button.blocklySave, workspace);
        } else {
        workspace.clear();
        }
      }
      var blocklyArea = document.getElementById('blocklyArea');
      var blocklyDiv = document.getElementById('blocklyDiv');
      var workspace = Blockly.inject(blocklyDiv,
          {toolbox: document.getElementById('toolbox-categories')});
      var resize = function(){
        if (window.innerWidth<700){
          //small
        }else{
          //med + lg++
          gebi("game").style.width=(window.innerWidth)+"px";
          gebi("game").style.height=(window.innerHeight)+"px";
          var xSplit = 0.45;
          gebi("gameLeft").style.width=(window.innerWidth*xSplit-2)+"px";
          gebi("gameRight").style.width=(window.innerWidth*(1-xSplit)-2)+"px";
          gebi("gameRight").style.left=(window.innerWidth*xSplit-2)+"px";
          var ySplit = 0.9;
          gebi("gameLeft").style.height=(window.innerHeight)+"px";
          gebi("gameRight").style.height=(window.innerHeight)+"px";
          gebi("gameGame").style.height=(window.innerHeight*ySplit-2)+"px";
          gebi("gameTools").style.height=(window.innerHeight*(1-ySplit)-2)+"px";
          gebi("gameTools").style.top=(window.innerHeight*ySplit-2)+"px";

          /*var element = blocklyArea;
          let x = 0;
          let y = 0;
          do {
            x += element.offsetLeft;
            y += element.offsetTop;
            element = element.offsetParent;
          } while (element);*/
          // Position blocklyDiv over blocklyArea.
          blocklyDiv.style.left = blocklyArea.offsetLeft + 'px';
          blocklyDiv.style.top = blocklyArea.offsetTop + 'px';
          blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
          blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
          Blockly.svgResize(workspace);
        }
      }
      window.onresize=resize;
      window.onload=function(){
        resize();
      }
      resize();
      gebi("menuPlay").addEventListener("click",function(){
        gebi("navbar").style.display="none";
        gebi("menu").style.display="none";
        gebi("contentBox").style.display="none";
        gebi("game").style.display="";
        resize();
      })
      gebi("run").addEventListener("click",function(){
        //do the javascript
        eval(Blockly.JavaScript.workspaceToCode(workspace));
      })
      gebi("sliderCheckBox").addEventListener("click",function(){
        if (gebi("sliderCheckBox").checked){
          //display js
          gebi("jsDiv").display="";
          gebi("blocklyDiv").display="none";
          gebi("jsDiv").innerHTML="";
          gebi("jsDiv").append(Blocky.JavaScript.workspaceToCode(workspace));
        }else{
          gebi("jsDiv").display="none";
          gebi("blocklyDiv").display="";
        }
      })
    
    zelda.contentDocument.funkyFunction = function j(x, y, rocks) {
      document.linkPos = {"x":x, "y":y};
      document.rocks = rocks;
    }
    
    var dirs = ['up', 'down', 'left', 'right']
    for (var dir of dirs){
      Blockly.Blocks[dir] = {
        init: function() {
          this.appendEndRowInput()
              .appendField(dir);
          this.setPreviousStatement(true, null);
          this.setNextStatement(true, null);
          this.setColour(230);
          this.setTooltip("");
          this.setHelpUrl("");
        }
      }
      javascript.javascriptGenerator.forBlock[dir] = function(block, generator) {
        // TODO: Assemble javascript into code variable.
        var code = 'zelda.contentDocument.linkDir="'+dir+'";';
        return code;
      };
    };

    var coords = ['x','y'];
    for (var pos of coords){
      Blockly.Blocks['link_'+pos] = {
        init: function() {
          this.appendEndRowInput()
              .appendField("link."+pos);
          this.setOutput(true, "Number");
          this.setColour(300);
          this.setTooltip("");
          this.setHelpUrl("");
        }
      };

      javascript.javascriptGenerator.forBlock['link_'+pos] = function(block, generator) {
        var code = 'return document.link.'+pos;
        return [code, Blockly.javascript.ORDER_NONE];
      };
    };

    Blockly.Blocks['rocks'] = {
        init: function() {
          this.appendEndRowInput()
              .appendField("rocks");
          this.setOutput(true, "Array");
          this.setColour(45);
          this.setTooltip("");
          this.setHelpUrl("");
        }
      };

      javascript.javascriptGenerator.forBlock['rocks'] = function(block, generator) {
        var code = 'return document.rocks';
        return [code, Blockly.javascript.ORDER_NONE];
      };
    
    </script>
  </body>
</html>